# ğŸ° USA28 æ•°æ®æºé›†æˆè¯´æ˜

## âœ… å·²å®Œæˆé›†æˆ

ç³»ç»Ÿå·²æˆåŠŸé›†æˆ **USA28 å½©ç¥¨æ•°æ®æº**ï¼Œè¿™æ˜¯å½“å‰å”¯ä¸€å¯ç”¨çš„ç¬¬ä¸‰æ–¹å¼€å¥–æ•°æ®æºã€‚

---

## ğŸ“Š æ•°æ®æºä¿¡æ¯

### USA28 API
- **æ¥å£åœ°å€**: `https://api.365kaik.com/api/v1/trend/getHistoryList`
- **å¯ç”¨æ€§**: âœ… 100% å¯ç”¨
- **æ›´æ–°é¢‘ç‡**: æ¯3-4åˆ†é’Ÿä¸€æœŸ
- **æ•°æ®æ ¼å¼**: JSON

### è¿”å›æ•°æ®ç¤ºä¾‹
```json
{
  "code": 0,
  "msg": "ok",
  "data": {
    "pageNum": 0,
    "totalCount": 384,
    "pageSize": 10,
    "list": [
      {
        "drawTime": "2025-11-26 18:53:30",
        "drawIssue": "3364535",
        "drawCode": "1,2,1",
        "groupCode": "pc28"
      }
    ]
  }
}
```

---

## ğŸ”„ æ•°æ®å¤„ç†æµç¨‹

### 1. æ•°æ®è·å–
```typescript
// ä»USA28 APIè·å–æœ€æ–°10æ¡å¼€å¥–è®°å½•
axios.get('https://api.365kaik.com/api/v1/trend/getHistoryList', {
  params: {
    lotCode: '10029',
    pageSize: '10',
    pageNum: '0'
  }
})
```

### 2. æ•°æ®è§£æ
```typescript
// USA28æ ¼å¼: "1,2,1"
const numbers = "1,2,1".split(',');
// â†’ [1, 2, 1]

// è½¬æ¢ä¸ºç³»ç»Ÿæ ¼å¼: "1+2+1"
const lott = numbers.join('+');
// â†’ "1+2+1"

// è®¡ç®—æ€»å’Œ
const sum = 1 + 2 + 1;
// â†’ 4
```

### 3. åˆ¤å®šè§„åˆ™
```typescript
// åˆ¤æ–­æ˜¯å¦å›æœ¬
isReturn(1, 2, 1, 4)
// â†’ { isReturn: false, reason: null }

// å¤§å°åˆ¤å®š (æ€»å’Œ4 < 14)
getSizeResult(4) â†’ "å°"

// å•åŒåˆ¤å®š (æ€»å’Œ4ä¸ºå¶æ•°)
getOddEvenResult(4) â†’ "åŒ"

// ç»„åˆåˆ¤å®š
getComboResult(4) â†’ "å°åŒ"
```

### 4. æ•°æ®ä¿å­˜
```typescript
await prisma.lotteryResult.create({
  data: {
    issue: "3364535",           // æœŸå·
    number1: 1,                 // ç¬¬ä¸€ä¸ªå·ç 
    number2: 2,                 // ç¬¬äºŒä¸ªå·ç 
    number3: 1,                 // ç¬¬ä¸‰ä¸ªå·ç 
    resultSum: 4,               // æ€»å’Œ
    isReturn: 0,                // æ˜¯å¦å›æœ¬
    returnReason: null,         // å›æœ¬åŸå› 
    sizeResult: "å°",           // å¤§å°
    oddEvenResult: "åŒ",        // å•åŒ
    comboResult: "å°åŒ",        // ç»„åˆ
    drawTime: new Date("2025-11-26 18:53:30"),
    isSettled: 0                // æœªç»“ç®—
  }
})
```

---

## ğŸš€ å¦‚ä½•ä½¿ç”¨

### æ–¹æ³•ä¸€ï¼šç®¡ç†åå°æ‰‹åŠ¨åŒæ­¥ï¼ˆæ¨èï¼‰

1. **ç™»å½•ç®¡ç†åå°**
   - è®¿é—®ï¼šhttp://localhost:5174
   - è´¦å·ï¼š`admin`
   - å¯†ç ï¼š`admin123`

2. **è¿›å…¥å¼€å¥–å†å²é¡µé¢**
   - ç‚¹å‡»å·¦ä¾§èœå•"å¼€å¥–å†å²"

3. **ç‚¹å‡»"åŒæ­¥å¼€å¥–æ•°æ®"æŒ‰é’®**
   - ç³»ç»Ÿä¼šè‡ªåŠ¨ä»USA28è·å–æœ€æ–°æ•°æ®
   - æ˜¾ç¤ºåŒæ­¥ç»“æœ

### æ–¹æ³•äºŒï¼šAPI ç›´æ¥è°ƒç”¨

```bash
# éœ€è¦å…ˆç™»å½•è·å– Token
curl -X POST http://localhost:3000/lottery/sync \
  -H "Authorization: Bearer YOUR_TOKEN"
```

**æˆåŠŸå“åº”ï¼š**
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "message": "æˆåŠŸåŒæ­¥ 10 æ¡å¼€å¥–æ•°æ®",
    "syncedCount": 10,
    "latestIssue": "3364535",
    "latestDrawTime": "2025-11-26T10:53:30.000Z",
    "totalRecords": 10
  }
}
```

---

## ğŸ“ æ•°æ®æ˜ å°„è¯´æ˜

| USA28 å­—æ®µ | ç³»ç»Ÿå­—æ®µ | è¯´æ˜ |
|-----------|---------|------|
| drawIssue | issue | æœŸå· |
| drawTime | drawTime | å¼€å¥–æ—¶é—´ |
| drawCode | number1, number2, number3 | å¼€å¥–å·ç ï¼ˆæ‹†åˆ†ï¼‰ |
| - | resultSum | ä¸‰ä¸ªå·ç ä¹‹å’Œ |
| - | isReturn | æ˜¯å¦å›æœ¬ï¼ˆç³»ç»Ÿè®¡ç®—ï¼‰ |
| - | sizeResult | å¤§å°ï¼ˆç³»ç»Ÿè®¡ç®—ï¼‰ |
| - | oddEvenResult | å•åŒï¼ˆç³»ç»Ÿè®¡ç®—ï¼‰ |
| - | comboResult | ç»„åˆï¼ˆç³»ç»Ÿè®¡ç®—ï¼‰ |

---

## ğŸ¯ å›æœ¬åˆ¤å®šè§„åˆ™

ç³»ç»Ÿä¼šè‡ªåŠ¨åˆ¤æ–­æ¯æœŸæ˜¯å¦å›æœ¬ï¼š

### å›æœ¬æ¡ä»¶
1. **è±¹å­**ï¼ˆä¸‰ä¸ªæ•°å­—ç›¸åŒï¼‰
   - ä¾‹ï¼š1+1+1, 2+2+2, 9+9+9
   
2. **é¡ºå­**ï¼ˆä¸‰ä¸ªè¿ç»­æ•°å­—ï¼‰
   - ä¾‹ï¼š1+2+3, 5+6+7, 7+8+9
   
3. **å¯¹å­**ï¼ˆä¸¤ä¸ªæ•°å­—ç›¸åŒï¼‰
   - ä¾‹ï¼š1+1+2, 5+5+8, 7+7+9
   
4. **ç‰¹æ®Šæ€»å’Œ**ï¼ˆ3æˆ–27ï¼‰
   - ä¾‹ï¼š1+1+1=3, 9+9+9=27

### ä¸å›æœ¬
- å…¶ä»–æƒ…å†µå‡ä¸ºä¸å›æœ¬

---

## ğŸ”§ ç³»ç»Ÿé…ç½®

### è‡ªåŠ¨åŒæ­¥è®¾ç½®

**æ–¹å¼1ï¼šåœ¨ç®¡ç†åå°é…ç½®**
1. è¿›å…¥"ç½‘ç«™è®¾ç½®"
2. æ‰¾åˆ°"è‡ªåŠ¨ç»“ç®—å¼€å…³"
3. å¼€å¯åä¼šè‡ªåŠ¨ç»“ç®—

**æ–¹å¼2ï¼šä¿®æ”¹ .env æ–‡ä»¶**
```env
# å¼€å¥–æ•°æ®æºï¼ˆå·²ç¡¬ç¼–ç ä¸ºUSA28ï¼Œæ­¤é…ç½®å·²ä¸ä½¿ç”¨ï¼‰
LOTTERY_DATA_SOURCE=https://api.365kaik.com/api/v1/trend/getHistoryList

# è‡ªåŠ¨ç»“ç®—å¼€å…³
AUTO_SETTLE_ENABLED=true
```

---

## ğŸ“Š åŒæ­¥æ—¥å¿—ç¤ºä¾‹

```
å¼€å§‹åŒæ­¥USA28å¼€å¥–æ•°æ®...
è¯·æ±‚USA28 API: https://api.365kaik.com/api/v1/trend/getHistoryList
USA28 APIå“åº”çŠ¶æ€: 0
è·å–åˆ° 10 æ¡å¼€å¥–è®°å½•
âœ“ æˆåŠŸä¿å­˜æœŸå· 3364535: 1+2+1=4
âœ“ æˆåŠŸä¿å­˜æœŸå· 3364534: 2+9+2=13
âœ“ æˆåŠŸä¿å­˜æœŸå· 3364533: 0+3+5=8
... (ç»§ç»­å¤„ç†)
æˆåŠŸåŒæ­¥ 10 æ¡å¼€å¥–æ•°æ®
```

---

## ğŸ› å¸¸è§é—®é¢˜

### é—®é¢˜1ï¼šåŒæ­¥å¤±è´¥ - ç½‘ç»œé”™è¯¯

**é”™è¯¯ä¿¡æ¯ï¼š**
```
USA28 APIæ— å“åº”ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥
```

**è§£å†³æ–¹æ¡ˆï¼š**
1. æ£€æŸ¥æœåŠ¡å™¨ç½‘ç»œè¿æ¥
2. ç¡®è®¤å¯ä»¥è®¿é—®å¤–ç½‘
3. æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
4. å°è¯•åœ¨æµè§ˆå™¨è®¿é—®ï¼šhttps://api.365kaik.com/

### é—®é¢˜2ï¼šæ²¡æœ‰æ–°æ•°æ®

**æç¤ºä¿¡æ¯ï¼š**
```
æ²¡æœ‰æ–°çš„å¼€å¥–æ•°æ®
```

**è¯´æ˜ï¼š**
- è¿™æ˜¯æ­£å¸¸æƒ…å†µ
- è¡¨ç¤ºæ•°æ®åº“ä¸­å·²æœ‰æœ€æ–°æ•°æ®
- USA28æ¯3-4åˆ†é’Ÿæ‰ä¼šæœ‰æ–°å¼€å¥–

### é—®é¢˜3ï¼šåŒæ­¥éƒ¨åˆ†æˆåŠŸ

**æ—¥å¿—æ˜¾ç¤ºï¼š**
```
è·å–åˆ° 10 æ¡å¼€å¥–è®°å½•
æœŸå· 3364535 å·²å­˜åœ¨ï¼Œè·³è¿‡
æœŸå· 3364534 å·²å­˜åœ¨ï¼Œè·³è¿‡
âœ“ æˆåŠŸä¿å­˜æœŸå· 3364533: 0+3+5=8
æˆåŠŸåŒæ­¥ 1 æ¡å¼€å¥–æ•°æ®
```

**è¯´æ˜ï¼š**
- è¿™æ˜¯æ­£å¸¸ç°è±¡
- ç³»ç»Ÿä¼šè‡ªåŠ¨è·³è¿‡å·²å­˜åœ¨çš„æ•°æ®
- åªåŒæ­¥æ–°æ•°æ®

---

## âœ… éªŒè¯åŒæ­¥æˆåŠŸ

### æ–¹æ³•1ï¼šæŸ¥çœ‹ç®¡ç†åå°

1. åˆ·æ–°"å¼€å¥–å†å²"é¡µé¢
2. åº”è¯¥èƒ½çœ‹åˆ°æ–°çš„å¼€å¥–è®°å½•
3. æ£€æŸ¥æœŸå·ã€å·ç ã€æ—¶é—´æ˜¯å¦æ­£ç¡®

### æ–¹æ³•2ï¼šæŸ¥çœ‹æ•°æ®åº“

```sql
-- æŸ¥çœ‹æœ€æ–°10æ¡è®°å½•
SELECT 
  issue,
  CONCAT(number1, '+', number2, '+', number3) as lott,
  result_sum,
  is_return,
  draw_time
FROM lottery_results
ORDER BY draw_time DESC
LIMIT 10;
```

### æ–¹æ³•3ï¼šæŸ¥çœ‹åç«¯æ—¥å¿—

æŸ¥çœ‹ç»ˆç«¯è¾“å‡ºï¼Œåº”è¯¥æœ‰ç±»ä¼¼æ—¥å¿—ï¼š
```
âœ“ æˆåŠŸä¿å­˜æœŸå· 3364535: 1+2+1=4
æˆåŠŸåŒæ­¥ 10 æ¡å¼€å¥–æ•°æ®
```

---

## ğŸ“ˆ æ•°æ®æ›´æ–°é¢‘ç‡

### USA28å¼€å¥–è§„å¾‹
- **å¼€å¥–é—´éš”**: 3åˆ†30ç§’
- **æ¯å°æ—¶**: çº¦17æœŸ
- **æ¯å¤©**: çº¦400+æœŸ

### å»ºè®®åŒæ­¥é¢‘ç‡
- **æ‰‹åŠ¨åŒæ­¥**: éšæ—¶å¯ä»¥
- **å®šæ—¶åŒæ­¥**: æ¯5åˆ†é’Ÿï¼ˆé€šè¿‡å®šæ—¶ä»»åŠ¡ï¼Œå¾…å®ç°ï¼‰

---

## ğŸ¯ ä¸‹ä¸€æ­¥æ“ä½œ

### ç«‹å³æµ‹è¯•

1. **ç­‰å¾…10ç§’**ï¼ˆè®©åç«¯é‡æ–°ç¼–è¯‘ï¼‰
2. **åˆ·æ–°æµè§ˆå™¨**ï¼ˆCtrl + Shift + Rï¼‰
3. **è¿›å…¥å¼€å¥–å†å²é¡µé¢**
4. **ç‚¹å‡»"åŒæ­¥å¼€å¥–æ•°æ®"æŒ‰é’®**
5. **æŸ¥çœ‹æ˜¯å¦æœ‰æ–°æ•°æ®**

### é¢„æœŸç»“æœ

âœ… çœ‹åˆ°æç¤ºï¼š"æˆåŠŸåŒæ­¥ X æ¡å¼€å¥–æ•°æ®"
âœ… å¼€å¥–å†å²åˆ—è¡¨æ˜¾ç¤ºæ–°æ•°æ®
âœ… æ•°æ®åŒ…å«ï¼šæœŸå·ã€å·ç ã€æ€»å’Œã€å¤§å°å•åŒã€æ—¶é—´

---

## ğŸ”„ æŒç»­ä¼˜åŒ–å»ºè®®

### 1. æ·»åŠ å®šæ—¶ä»»åŠ¡

æ¯5åˆ†é’Ÿè‡ªåŠ¨åŒæ­¥ï¼š
```typescript
@Cron('*/5 * * * *')
async autoSync() {
  await this.syncLotteryData();
}
```

### 2. æ·»åŠ æ•°æ®æºåˆ‡æ¢

å‡†å¤‡å¤‡ç”¨æ•°æ®æºï¼Œå®ç°æ•…éšœè½¬ç§»ã€‚

### 3. æ·»åŠ ç›‘æ§å‘Šè­¦

æ•°æ®åŒæ­¥å¤±è´¥æ—¶å‘é€é€šçŸ¥ã€‚

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

é‡åˆ°é—®é¢˜ï¼Ÿ
1. æŸ¥çœ‹åç«¯ç»ˆç«¯æ—¥å¿—
2. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰
3. æ£€æŸ¥ç½‘ç»œè¿æ¥
4. è”ç³»æŠ€æœ¯äººå‘˜

---

**é›†æˆå®Œæˆæ—¶é—´**: 2024-11-27  
**æ•°æ®æº**: USA28 å½©ç¥¨  
**çŠ¶æ€**: âœ… å·²ä¸Šçº¿å¯ç”¨

---

**ğŸ‰ ç°åœ¨å¯ä»¥å¼€å§‹åŒæ­¥æ•°æ®äº†ï¼**

è¯·ç­‰å¾…10ç§’è®©åç«¯é‡æ–°ç¼–è¯‘ï¼Œç„¶åï¼š
1. åˆ·æ–°æµè§ˆå™¨
2. è¿›å…¥"å¼€å¥–å†å²"
3. ç‚¹å‡»"åŒæ­¥å¼€å¥–æ•°æ®"
4. æŸ¥çœ‹ç»“æœï¼






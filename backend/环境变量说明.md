# 环境变量配置说明

## 必需配置

### 数据库配置
```env
DATABASE_URL="mysql://用户名:密码@主机:端口/数据库名"
```
示例：
```env
DATABASE_URL="mysql://root:123456@localhost:3306/score_system"
```

### JWT配置
```env
JWT_SECRET="your-super-secret-key"          # JWT密钥，请务必修改
JWT_EXPIRES_IN="7d"                          # 用户Token有效期
JWT_ADMIN_EXPIRES_IN="12h"                   # 管理员Token有效期
```

### 应用配置
```env
PORT=3000                                    # 服务器端口
NODE_ENV="development"                       # 运行环境：development/production
```

---

## 可选配置

### Redis配置（暂未使用，预留）
```env
REDIS_HOST="localhost"
REDIS_PORT=6379
REDIS_PASSWORD=""
REDIS_DB=0
```

### CORS配置
```env
CORS_ORIGIN="http://localhost:5173,http://localhost:5174"  # 允许的前端地址
```

### 开奖数据源
```env
LOTTERY_DATA_SOURCE="http://your-old-system.com/api/lottery/latest"
```
说明：指向旧系统的开奖数据API地址

### 腾讯云COS配置（如需使用）
```env
COS_SECRET_ID=""
COS_SECRET_KEY=""
COS_BUCKET=""
COS_REGION=""
```

### 日志配置
```env
LOG_LEVEL="info"                             # 日志级别：debug/info/warn/error
LOG_DIR="./logs"                             # 日志目录
```

### 其他配置
```env
SALT_ROUNDS=10                               # bcrypt加密轮数
```

---

## 完整示例

创建 `.env` 文件：

```env
# ===================
# 必需配置
# ===================

# 数据库配置
DATABASE_URL="mysql://root:123456@localhost:3306/score_system"

# JWT配置
JWT_SECRET="change-this-to-your-secret-key-in-production"
JWT_EXPIRES_IN="7d"
JWT_ADMIN_EXPIRES_IN="12h"

# 应用配置
PORT=3000
NODE_ENV="development"

# ===================
# 可选配置
# ===================

# Redis配置
REDIS_HOST="localhost"
REDIS_PORT=6379
REDIS_PASSWORD=""
REDIS_DB=0

# CORS配置
CORS_ORIGIN="http://localhost:5173,http://localhost:5174,http://localhost:8080"

# 开奖数据源（请修改为实际地址）
LOTTERY_DATA_SOURCE="http://old-system.example.com/api/lottery/latest"

# 腾讯云COS配置（可选）
COS_SECRET_ID=""
COS_SECRET_KEY=""
COS_BUCKET=""
COS_REGION=""

# 日志配置
LOG_LEVEL="info"
LOG_DIR="./logs"

# 其他配置
SALT_ROUNDS=10
```

---

## 安全注意事项

### 生产环境必须修改：
1. ✅ `JWT_SECRET` - 使用强随机字符串
2. ✅ `DATABASE_URL` - 使用强密码
3. ✅ `NODE_ENV` - 设置为 "production"

### 推荐做法：
- 不要将 `.env` 文件提交到Git
- 每个环境使用不同的配置
- 定期更换密钥
- 使用环境变量管理工具

---

## 不同环境配置

### 开发环境 (.env.development)
```env
NODE_ENV="development"
DATABASE_URL="mysql://root:123456@localhost:3306/score_system_dev"
LOG_LEVEL="debug"
```

### 测试环境 (.env.test)
```env
NODE_ENV="test"
DATABASE_URL="mysql://root:123456@localhost:3306/score_system_test"
LOG_LEVEL="warn"
```

### 生产环境 (.env.production)
```env
NODE_ENV="production"
DATABASE_URL="mysql://produser:strong_password@db.example.com:3306/score_system"
JWT_SECRET="production-secret-key-very-strong"
LOG_LEVEL="error"
CORS_ORIGIN="https://your-domain.com"
```

---

## 验证配置

启动应用后，检查日志输出：
```
✓ 数据库连接成功
✓ JWT配置加载成功
✓ CORS配置生效
✓ 应用启动在端口 3000
```

如果配置有误，会看到相应的错误提示。

---

**创建日期**：2024年11月26日




# 前端倍数选择功能实现 ✅

## 📋 需求

**问题**：前端倍数下注无法选择下注倍数，只能根据金额来  
**解决**：添加倍数选择器，根据倍数自动计算金额

---

## 🎯 功能设计

### UI结构

```
倍数下注面板
  ├─ 每倍金额设置（1-1000积分，默认100）
  ├─ 倍数选择器（1-100倍，默认1倍）
  ├─ 快捷倍数按钮（1倍、2倍、5倍、10倍、20倍、50倍）
  ├─ 总金额显示（自动计算 = 每倍金额 × 倍数）
  ├─ 手续费显示
  └─ 确认下注按钮
```

### 计算逻辑

```
总金额 = 每倍金额 × 倍数

例子：
- 每倍100积分，选择10倍 = 1000积分
- 每倍50积分，选择20倍 = 1000积分
```

---

## 🔧 实现细节

### 1. 数据结构

**修改前**：
```typescript
const multipleBet = reactive({
  amount: '',  // 只有金额输入
})
```

**修改后**：
```typescript
const multipleBet = reactive({
  perMultiplierAmount: 100,  // 每倍金额，默认100
  multiplier: 1,              // 倍数，默认1倍
  amount: '',                 // 总金额（自动计算）
})

// 快捷倍数选项
const quickMultipliers = ref([1, 2, 5, 10, 20, 50])
```

---

### 2. UI组件

#### 每倍金额设置

```vue
<div class="per-multiplier-setting">
  <span class="label">每倍金额：</span>
  <van-stepper
    v-model="multipleBet.perMultiplierAmount"
    :min="1"
    :max="1000"
    :step="1"
  />
  <span class="unit">积分</span>
</div>
```

**功能**：
- 最小1积分，最大1000积分
- 步进1
- 默认100积分

---

#### 倍数选择器

```vue
<div class="multiplier-selector">
  <span class="label">选择倍数：</span>
  <van-stepper
    v-model="multipleBet.multiplier"
    :min="1"
    :max="100"
    :step="1"
    @change="onMultiplierChange"
  />
  <span class="unit">倍</span>
</div>
```

**功能**：
- 最小1倍，最大100倍
- 步进1
- 默认1倍
- 变化时自动计算总金额

---

#### 快捷倍数按钮

```vue
<div class="quick-multiplier-buttons">
  <van-button
    v-for="mult in quickMultipliers"
    :key="mult"
    size="small"
    :type="multipleBet.multiplier === mult ? 'primary' : 'default'"
    @click="setQuickMultiplier(mult)"
  >
    {{ mult }}倍
  </van-button>
</div>
```

**功能**：
- 快速选择常用倍数：1、2、5、10、20、50倍
- 当前倍数高亮显示
- 点击后自动计算总金额

---

#### 总金额显示

```vue
<div class="total-amount-display">
  <span class="label">下注金额：</span>
  <span class="value">{{ calculateMultipleAmount() }}</span>
  <span class="unit">积分</span>
</div>
```

**功能**：
- 实时显示总金额
- 渐变背景突出显示
- 大字体、粗体

---

### 3. 计算方法

#### 计算总金额

```typescript
const calculateMultipleAmount = () => {
  const total = multipleBet.perMultiplierAmount * multipleBet.multiplier
  multipleBet.amount = String(total)
  return formatMoney(total)
}
```

#### 倍数变化处理

```typescript
const onMultiplierChange = () => {
  calculateMultipleAmount()
}
```

#### 快捷倍数设置

```typescript
const setQuickMultiplier = (mult: number) => {
  multipleBet.multiplier = mult
  calculateMultipleAmount()
}
```

---

### 4. 样式设计

#### 每倍金额设置样式

```scss
.per-multiplier-setting {
  display: flex;
  align-items: center;
  padding: 12px 16px;
  background: $background-color;
  border-radius: 8px;
  margin-bottom: 12px;

  .label {
    font-size: 14px;
    color: $text-color-secondary;
    margin-right: 12px;
    min-width: 80px;
  }

  .van-stepper {
    flex: 1;
  }

  .unit {
    font-size: 14px;
    color: $text-color-secondary;
    margin-left: 8px;
  }
}
```

#### 总金额显示样式

```scss
.total-amount-display {
  display: flex;
  align-items: center;
  padding: 12px 16px;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  border-radius: 8px;
  margin-bottom: 12px;

  .label {
    font-size: 14px;
    color: rgba(255, 255, 255, 0.8);
    margin-right: 8px;
  }

  .value {
    flex: 1;
    font-size: 24px;
    font-weight: 700;
    color: #fff;
    text-align: right;
  }

  .unit {
    font-size: 14px;
    color: rgba(255, 255, 255, 0.8);
    margin-left: 8px;
  }
}
```

---

## 📱 使用示例

### 示例1：选择10倍

```
1. 每倍金额：100积分（默认）
2. 选择倍数：点击"10倍"按钮
3. 总金额显示：1,000积分
4. 手续费：30积分（1000/100×3）
5. 确认下注
```

### 示例2：自定义倍数

```
1. 每倍金额：50积分
2. 选择倍数：使用+-按钮调整到20倍
3. 总金额显示：1,000积分
4. 手续费：30积分
5. 确认下注
```

### 示例3：大额下注

```
1. 每倍金额：1000积分
2. 选择倍数：5倍
3. 总金额显示：5,000积分
4. 手续费：150积分（5000/100×3）
5. 确认下注
```

---

## 🎨 UI预览

### 倍数下注面板

```
┌─────────────────────────────────────┐
│  每倍金额：[  -  ]  100  [ +  ] 积分  │
├─────────────────────────────────────┤
│  选择倍数：[  -  ]   10  [ +  ] 倍    │
├─────────────────────────────────────┤
│  [ 1倍 ] [ 2倍 ] [ 5倍 ]            │
│  [10倍■] [20倍 ] [50倍 ]            │  ← 当前选中10倍
├─────────────────────────────────────┤
│  下注金额：            1,000 积分     │  ← 渐变背景
├─────────────────────────────────────┤
│  手续费：30.00                      │
├─────────────────────────────────────┤
│  ℹ 回本情况：对子、豹子、顺子、总和13/14│
├─────────────────────────────────────┤
│          [ 确认下注 ]                │
└─────────────────────────────────────┘
```

---

## ✅ 功能特点

### 1. 灵活性

✅ 可以调整每倍金额（1-1000）  
✅ 可以调整倍数（1-100）  
✅ 快捷倍数按钮便捷操作

### 2. 直观性

✅ 实时显示总金额  
✅ 大字体、渐变背景突出显示  
✅ 自动计算手续费

### 3. 易用性

✅ 使用Vant Stepper组件，UI统一  
✅ 快捷按钮快速选择常用倍数  
✅ 默认值合理（每倍100，1倍）

### 4. 扩展性

✅ 可配置每倍金额范围  
✅ 可配置倍数范围  
✅ 可自定义快捷倍数选项

---

## 🔄 与后端交互

### 提交数据格式（不变）

```typescript
{
  issue: "3364886",
  betType: "multiple",
  betContent: "1000",  // 总金额（字符串）
  amount: 1000         // 总金额（数字）
}
```

**说明**：后端接收的仍然是总金额，无需修改后端代码

---

## 🧪 测试要点

### 功能测试

- [ ] 调整每倍金额，总金额正确计算
- [ ] 调整倍数，总金额正确计算
- [ ] 快捷倍数按钮正常工作
- [ ] 手续费计算正确（总金额/100×3）
- [ ] 提交下注成功
- [ ] 下注后表单重置为默认值（每倍100，1倍）

### 边界测试

- [ ] 每倍金额最小值1
- [ ] 每倍金额最大值1000
- [ ] 倍数最小值1
- [ ] 倍数最大值100
- [ ] 总金额超过用户积分时提示"积分不足"

### UI测试

- [ ] 样式显示正常
- [ ] 总金额区域渐变背景正常
- [ ] 响应式布局正常
- [ ] 按钮状态切换正常

---

## 📦 部署步骤

### 1. 停止前端服务

```bash
# 如果前端正在运行，先停止
```

### 2. 重新构建（如果使用Docker）

```bash
cd D:\download\yunce\yunce\score-system
docker-compose build frontend-h5
docker-compose up -d frontend-h5
```

### 3. 或直接开发模式运行

```bash
cd D:\download\yunce\yunce\score-system\frontend-h5
npm run dev
```

---

## 🎉 总结

### 核心改进

✅ **添加倍数选择器**：用户可以选择1-100倍  
✅ **添加每倍金额设置**：灵活配置每倍对应的积分  
✅ **快捷倍数按钮**：快速选择常用倍数  
✅ **实时计算总金额**：自动计算 = 每倍金额 × 倍数  
✅ **美观的UI**：渐变背景突出显示总金额

### 用户体验提升

🚀 **更直观**：看到倍数更容易理解  
🚀 **更快捷**：点击快捷按钮快速下注  
🚀 **更灵活**：可以自定义每倍金额

**现在用户可以方便地选择倍数进行下注了！** 🎊




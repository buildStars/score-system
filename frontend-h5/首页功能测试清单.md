# 🧪 首页功能测试清单

## 📋 测试准备

### 1. 服务启动检查
- [ ] 后端服务：http://localhost:3000 ✅
- [ ] H5前端：http://localhost:5173 ✅
- [ ] 数据库：MySQL连接正常 ✅

### 2. 测试账号准备
需要在后端创建测试用户：
```sql
-- 测试用户
username: user001
password: 123456
points: 5000
```

---

## 🎯 首页核心功能测试

### 功能1：页面加载
**测试步骤**：
1. 登录系统
2. 进入首页（/）

**预期结果**：
- [ ] 页面正常渲染
- [ ] 没有控制台错误
- [ ] 所有组件正常显示

---

### 功能2：显示当前积分和期号

**涉及API**：
- GET `/api/user/info` - 获取用户积分
- GET `/api/lottery/current` - 获取当前期号

**测试步骤**：
1. 进入首页
2. 查看顶部信息栏

**预期结果**：
- [ ] 显示正确的用户积分（如：5000）
- [ ] 显示当前期号（7位数字）
- [ ] 数据实时更新

**测试数据**：
```json
{
  "userInfo": {
    "points": 5000
  },
  "lotteryInfo": {
    "currentIssue": "3330422"
  }
}
```

---

### 功能3：实时倒计时

**涉及API**：
- GET `/api/lottery/current` - 获取倒计时秒数

**测试步骤**：
1. 观察倒计时组件
2. 检查是否每秒递减
3. 倒计时结束后检查刷新

**预期结果**：
- [ ] 倒计时正常显示（格式：MM:SS）
- [ ] 每秒自动减1
- [ ] 倒计时结束后自动刷新数据
- [ ] 倒计时为0时显示"加载中..."

**测试数据**：
```json
{
  "countdown": 180  // 3分钟=180秒
}
```

---

### 功能4：上期开奖结果展示

**涉及API**：
- GET `/api/lottery/current` - 获取lastResult

**测试步骤**：
1. 查看"上期开奖"卡片
2. 检查开奖号码显示
3. 检查统计标签

**预期结果**：
- [ ] 显示期号
- [ ] 显示三个开奖号码（圆形）
- [ ] 显示总和
- [ ] 显示大小标签（大/小）
- [ ] 显示单双标签（单/双）
- [ ] 如果回本，显示"回本"标签和原因

**测试数据**：
```json
{
  "lastResult": {
    "issue": "3330421",
    "number1": 6,
    "number2": 8,
    "number3": 9,
    "resultSum": 23,
    "isReturn": 1,
    "returnReason": "顺子",
    "sizeResult": "大",
    "oddEvenResult": "单"
  }
}
```

---

### 功能5：倍数下注

**涉及API**：
- POST `/api/user/bet` - 提交下注

**测试步骤**：
1. 点击"倍数下注"选项卡
2. 输入下注倍数（如：100）
3. 查看手续费计算
4. 点击"确认下注"
5. 确认弹窗中检查信息
6. 点击确认提交

**预期结果**：
- [ ] 输入框正常工作
- [ ] 手续费正确计算（100倍 → 手续费3）
- [ ] 显示回本规则提示
- [ ] 弹窗显示下注详情
- [ ] 提交成功后显示"下注成功"
- [ ] 积分自动扣除并更新
- [ ] 表单自动清空

**测试数据**：
```typescript
// 请求
{
  "issue": "3330422",
  "betType": "multiple",
  "betContent": "100",
  "amount": 100
}

// 手续费计算
fee = (amount / 100) * 3 = (100 / 100) * 3 = 3
```

---

### 功能6：组合下注

**涉及API**：
- POST `/api/user/bet` - 提交下注

**测试步骤**：
1. 点击"组合下注"选项卡
2. 选择组合（如：大）
3. 输入下注金额（如：100）
4. 查看手续费计算
5. 点击"确认下注"
6. 确认弹窗中检查信息
7. 点击确认提交

**预期结果**：
- [ ] 8种组合按钮正常显示（大、小、单、双、大单、大双、小单、小双）
- [ ] 点击选择组合正常工作
- [ ] 输入金额框正常工作
- [ ] 手续费正确计算（100金额 → 手续费5）
- [ ] 显示中奖规则提示
- [ ] 弹窗显示下注详情
- [ ] 提交成功后显示"下注成功"
- [ ] 积分自动扣除并更新
- [ ] 表单自动清空

**测试数据**：
```typescript
// 请求
{
  "issue": "3330422",
  "betType": "combo",
  "betContent": "大",
  "amount": 100
}

// 手续费计算
fee = (amount / 100) * 5 = (100 / 100) * 5 = 5
```

---

### 功能7：游戏开关控制

**涉及API**：
- GET `/api/lottery/current` - 获取gameEnabled

**测试步骤**：
1. 管理员关闭游戏
2. 刷新首页
3. 尝试下注

**预期结果**：
- [ ] 下注按钮显示"游戏已暂停"
- [ ] 下注按钮禁用状态
- [ ] 无法提交下注
- [ ] 提示信息友好

**测试数据**：
```json
{
  "gameEnabled": false
}
```

---

### 功能8：系统公告

**涉及API**：
- GET `/api/lottery/current` - 获取systemNotice

**测试步骤**：
1. 查看页面顶部
2. 检查公告条显示

**预期结果**：
- [ ] 公告栏正常显示
- [ ] 内容滚动播放
- [ ] 带有图标

**测试数据**：
```json
{
  "systemNotice": "欢迎使用计分系统！"
}
```

---

### 功能9：错误处理

**测试场景**：

#### 9.1 积分不足
**步骤**：下注金额 > 当前积分

**预期**：
- [ ] 显示"积分不足"提示
- [ ] 不提交下注请求

#### 9.2 网络错误
**步骤**：关闭后端，尝试下注

**预期**：
- [ ] 显示"网络错误"提示
- [ ] 不崩溃

#### 9.3 Token过期
**步骤**：清除Token，刷新页面

**预期**：
- [ ] 自动跳转到登录页
- [ ] 显示"请重新登录"

---

## 🔧 技术检查

### API请求检查
打开浏览器开发者工具 → Network

1. **GET /api/user/info**
   - [ ] 请求成功（200）
   - [ ] 返回用户信息
   - [ ] 包含积分字段

2. **GET /api/lottery/current**
   - [ ] 请求成功（200）
   - [ ] 返回当前期信息
   - [ ] 包含倒计时、上期结果

3. **POST /api/user/bet**
   - [ ] 请求成功（200）
   - [ ] 请求体格式正确
   - [ ] 返回下注结果

### 状态管理检查
打开Vue DevTools → Pinia

1. **userStore**
   - [ ] token已保存
   - [ ] userInfo已保存
   - [ ] points正确

2. **lotteryStore**
   - [ ] currentIssue已保存
   - [ ] countdown已保存
   - [ ] lastResult已保存

---

## 📊 性能检查

### 页面加载
- [ ] 首屏加载时间 < 2秒
- [ ] 没有不必要的重复请求
- [ ] 图片加载正常

### 交互响应
- [ ] 点击按钮响应快速
- [ ] 输入框无卡顿
- [ ] 页面切换流畅

---

## 🐛 问题记录

### 发现的问题
| 序号 | 问题描述 | 严重程度 | 状态 |
|------|---------|---------|------|
| 1    |         |         |      |
| 2    |         |         |      |

### 修复记录
| 序号 | 修复内容 | 修复时间 | 修复人 |
|------|---------|---------|--------|
| 1    |         |         |        |
| 2    |         |         |        |

---

## ✅ 测试结论

### 通过条件
- [ ] 所有核心功能正常
- [ ] 所有API对接成功
- [ ] 没有严重Bug
- [ ] 用户体验良好

### 测试状态
- [ ] **通过** - 所有功能正常
- [ ] **有问题** - 存在Bug需要修复
- [ ] **阻塞** - 无法继续测试

---

## 📝 测试报告

**测试人员**：___________  
**测试日期**：2024年11月26日  
**测试环境**：开发环境  
**测试结果**：___________

---

**文档版本**：v1.0  
**创建日期**：2024年11月26日






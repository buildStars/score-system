# ⚙️ 快捷金额自定义设置功能

## ✅ 功能已完成

**添加时间**：2024年11月26日  
**功能**：用户可以自定义快捷金额配置，保存到本地存储

---

## 🎯 功能特性

### 1. 设置入口

**位置**：首页顶部信息栏右上角

```
┌─────────────────────────────┐
│ 当前积分     当前期号    ⚙️  │ ← 设置图标
└─────────────────────────────┘
```

**交互**：
- 点击设置图标（⚙️）
- 弹出快捷金额设置弹窗

---

### 2. 设置弹窗

**界面展示**：
```
┌─────────────────────────────┐
│     快捷金额设置            │
├─────────────────────────────┤
│ ℹ️ 请设置5个快捷金额，方便快速下注 │
├─────────────────────────────┤
│ 金额 1：[100]               │
│ 金额 2：[500]               │
│ 金额 3：[1000]              │
│ 金额 4：[5000]              │
│ 金额 5：[10000]             │
├─────────────────────────────┤
│    [取消]      [确认]        │
└─────────────────────────────┘
```

---

## 💡 使用流程

### 设置快捷金额

**步骤**：
1. 点击首页右上角的设置图标 ⚙️
2. 弹出设置弹窗
3. 修改5个金额输入框的值
4. 点击"确认"保存

**示例**：
```
原配置：100, 500, 1000, 5000, 10000

修改为：50, 200, 800, 3000, 8000

保存后，快捷金额按钮显示：
[50] [200] [800] [3000] [8000]
```

---

## 🔧 功能实现

### 1. 数据存储

**存储位置**：localStorage

```typescript
// 保存配置
localStorage.setItem('quickAmounts', JSON.stringify([100, 500, 1000, 5000, 10000]))

// 读取配置
const stored = localStorage.getItem('quickAmounts')
const quickAmounts = JSON.parse(stored)
```

**数据格式**：
```json
[100, 500, 1000, 5000, 10000]
```

---

### 2. 配置验证

**验证规则**：
1. ✅ 必须输入5个金额
2. ✅ 金额必须大于0
3. ✅ 金额不能重复
4. ✅ 自动排序（从小到大）

**示例**：
```typescript
// 输入：1000, 100, 5000, 500, 10000
// 验证通过后自动排序为：100, 500, 1000, 5000, 10000
```

---

### 3. 初始化加载

```typescript
// 页面加载时从localStorage读取
const getStoredQuickAmounts = () => {
  const stored = localStorage.getItem('quickAmounts')
  if (stored) {
    try {
      const parsed = JSON.parse(stored)
      if (Array.isArray(parsed) && parsed.length === 5) {
        return parsed.map(Number)
      }
    } catch (e) {
      console.error('解析快捷金额配置失败', e)
    }
  }
  // 默认值
  return [100, 500, 1000, 5000, 10000]
}

const quickAmounts = ref(getStoredQuickAmounts())
```

---

## ⚠️ 验证提示

### 1. 金额数量不足
```
❌ 错误：只输入了3个金额
提示：请输入5个有效的金额
```

### 2. 金额重复
```
❌ 错误：输入了重复的金额（如：100, 100, 500, 1000, 5000）
提示：金额不能重复
```

### 3. 金额无效
```
❌ 错误：输入了0或负数
提示：请输入5个有效的金额
```

### 4. 保存成功
```
✅ 成功：保存配置成功
提示：保存成功
```

---

## 📱 交互效果

### 打开设置
```
点击设置图标 ⚙️
  ↓
弹出设置弹窗
  ↓
输入框显示当前配置
```

### 修改金额
```
修改输入框的值
  ↓
点击"确认"
  ↓
验证输入
  ↓
保存到localStorage
  ↓
更新快捷金额按钮
  ↓
显示"保存成功"
```

### 取消设置
```
点击"取消"
  ↓
恢复原配置
  ↓
关闭弹窗
```

---

## 🎨 界面设计

### 1. 设置图标
- 位置：右上角
- 图标：⚙️ (setting-o)
- 颜色：灰色 (#999)
- 大小：20px
- 交互：点击打开弹窗

### 2. 设置弹窗
- 标题：快捷金额设置
- 提示：橙色背景提示条
- 输入框：5个，带标签
- 按钮：取消 + 确认

### 3. 提示信息
- 图标：ℹ️ (info-o)
- 背景：浅橙色 (#fff7e6)
- 文字：橙色 (#ff976a)

---

## 🔄 使用场景

### 场景1：新手用户
```
默认配置：100, 500, 1000, 5000, 10000
适合：试探性下注
```

### 场景2：小额玩家
```
自定义配置：50, 100, 200, 500, 1000
适合：控制风险，小额多次
```

### 场景3：中等玩家
```
自定义配置：200, 500, 1000, 2000, 5000
适合：常规投注
```

### 场景4：大额玩家
```
自定义配置：1000, 5000, 10000, 20000, 50000
适合：大额投注
```

### 场景5：VIP玩家
```
自定义配置：5000, 10000, 50000, 100000, 200000
适合：高额投注
```

---

## 📊 技术实现

### 核心代码

```typescript
// 1. 读取配置
const getStoredQuickAmounts = () => {
  const stored = localStorage.getItem('quickAmounts')
  if (stored) {
    return JSON.parse(stored)
  }
  return [100, 500, 1000, 5000, 10000]
}

// 2. 保存配置
const onSaveQuickAmounts = async (action: string) => {
  if (action === 'confirm') {
    // 验证输入
    const amounts = tempQuickAmounts.value
      .map(v => Number(v))
      .filter(v => v > 0)
    
    if (amounts.length !== 5) {
      showToast('请输入5个有效的金额')
      return false
    }

    // 检查重复
    const uniqueAmounts = [...new Set(amounts)]
    if (uniqueAmounts.length !== 5) {
      showToast('金额不能重复')
      return false
    }

    // 排序并保存
    const sortedAmounts = amounts.sort((a, b) => a - b)
    quickAmounts.value = sortedAmounts
    localStorage.setItem('quickAmounts', JSON.stringify(sortedAmounts))
    
    showToast('保存成功')
    return true
  }
  return true
}

// 3. 监听弹窗
watch(showQuickAmountSetting, (show) => {
  if (show) {
    tempQuickAmounts.value = quickAmounts.value.map(String)
  }
})
```

---

## ✨ 功能亮点

### 1. 个性化配置 🎯
- 用户可以根据自己的习惯设置快捷金额
- 灵活调整，满足不同需求

### 2. 本地存储 💾
- 配置保存在localStorage
- 刷新页面后配置依然有效
- 不需要服务器支持

### 3. 智能验证 🔍
- 自动验证输入
- 防止错误配置
- 友好的错误提示

### 4. 自动排序 📊
- 金额自动从小到大排序
- 保持界面整洁有序

### 5. 易于使用 👍
- 一键打开设置
- 直观的输入界面
- 即时生效

---

## 🚀 扩展功能建议

### 1. 预设方案
```typescript
const presetSchemes = {
  '新手': [50, 100, 200, 500, 1000],
  '普通': [100, 500, 1000, 5000, 10000],
  '进阶': [500, 1000, 5000, 10000, 50000],
  'VIP': [1000, 5000, 10000, 50000, 100000],
}
```

### 2. 快速切换
```vue
<van-tabs v-model:active="schemeType">
  <van-tab title="新手" />
  <van-tab title="普通" />
  <van-tab title="进阶" />
  <van-tab title="VIP" />
  <van-tab title="自定义" />
</van-tabs>
```

### 3. 导入导出
```typescript
// 导出配置
const exportConfig = () => {
  const config = JSON.stringify(quickAmounts.value)
  // 复制到剪贴板或下载
}

// 导入配置
const importConfig = (configStr: string) => {
  const config = JSON.parse(configStr)
  quickAmounts.value = config
}
```

### 4. 云端同步
```typescript
// 保存到服务器
const syncToServer = async () => {
  await userApi.saveQuickAmounts({
    amounts: quickAmounts.value
  })
}

// 从服务器读取
const syncFromServer = async () => {
  const res = await userApi.getQuickAmounts()
  quickAmounts.value = res.data.amounts
}
```

---

## 📋 完成清单

- [x] 添加设置图标入口
- [x] 创建设置弹窗
- [x] 实现5个金额输入框
- [x] 实现配置验证
- [x] 实现localStorage存储
- [x] 实现配置读取
- [x] 实现自动排序
- [x] 添加成功/失败提示
- [x] 优化UI样式
- [x] 编写功能文档

---

## 🎉 总结

### 功能完成
- ✅ 设置入口（右上角图标）
- ✅ 设置弹窗（5个输入框）
- ✅ 数据验证（数量、重复、有效性）
- ✅ 本地存储（localStorage）
- ✅ 自动排序（从小到大）
- ✅ 友好提示（成功/失败）

### 用户收益
- 🌟 个性化配置，满足不同需求
- 🌟 操作简单，一键设置
- 🌟 配置持久化，无需重复设置
- 🌟 智能验证，避免错误

---

**快捷金额自定义设置功能已完成！** ✅🎉

用户现在可以根据自己的习惯自定义快捷金额配置了！




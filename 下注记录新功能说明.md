# ä¸‹æ³¨è®°å½•æ–°åŠŸèƒ½è¯´æ˜ ğŸ“Š

## åŠŸèƒ½æ¦‚è¿°

å…¨æ–°è®¾è®¡çš„ä¸‹æ³¨è®°å½•é¡µé¢ï¼ŒåŒ…å«ä¸‰å¤§æ ¸å¿ƒåŠŸèƒ½ï¼š
1. **ç²¾ç®€æŸ¥è¯¢åŒº** - æœŸå· + ç”¨æˆ· å¿«é€Ÿç­›é€‰
2. **ä¸‹æ³¨æ˜ç»†åˆ—è¡¨** - æ¸…æ™°å±•ç¤ºæ¯ç¬”ä¸‹æ³¨
3. **æ‰€æœ‰äººä¸‹æ³¨æ€»å’Œ** - å®æ—¶æ±‡æ€»ç»Ÿè®¡ + é™¤æ•°æŠ˜ç®—æ˜¾ç¤º

## ä¸€ã€æŸ¥è¯¢åŒºåŸŸï¼ˆé¡¶éƒ¨ï¼‰

### å­—æ®µ
- **æœŸå·è¾“å…¥æ¡†** - æŒ‰æœŸå·ç­›é€‰
- **ç”¨æˆ·è¾“å…¥æ¡†** - æŒ‰ç”¨æˆ·IDæˆ–ç”¨æˆ·åç­›é€‰
- **æœç´¢æŒ‰é’®** - æ‰§è¡ŒæŸ¥è¯¢
- **é‡ç½®æŒ‰é’®** - æ¸…ç©ºç­›é€‰æ¡ä»¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [æœŸå·______] [ç”¨æˆ·______] [æœç´¢] [é‡ç½®]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## äºŒã€ä¸‹æ³¨æ˜ç»†åˆ—è¡¨ï¼ˆä¸­é—´è¡¨æ ¼ï¼‰

### åˆ—è¡¨ç»“æ„
| åˆ—å | è¯´æ˜ | å®½åº¦ |
|------|------|------|
| æœŸå· | ä¸‹æ³¨æœŸå· | 120px |
| ç”¨æˆ· | ç”¨æˆ·æ˜µç§°/ID | 150px |
| ä¸‹æ³¨å†…å®¹ | ç©æ³• + å†…å®¹ + é‡‘é¢ | è‡ªé€‚åº” |
| ç»“ç®—ç»“æœ | ç›ˆäºé‡‘é¢ | 150px |
| å‰©ä½™ | ç»“ç®—åä½™é¢ | 120px |
| æ—¶é—´ | ä¸‹æ³¨æ—¶é—´ | 180px |

### æ˜¾ç¤ºæ ·å¼
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æœŸå·       â”‚ ç”¨æˆ·      â”‚ ä¸‹æ³¨å†…å®¹                  â”‚ ç»“æœ  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 20231127001â”‚ å¼ ä¸‰      â”‚ [å€æ•°] 2  Â¥500.00        â”‚ +Â¥500 â”‚
â”‚            â”‚ ID: 1001  â”‚                          â”‚       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 20231127001â”‚ æå››      â”‚ [ç»„åˆ] å¤§å•  Â¥100.00     â”‚ æœªç»“ç®—â”‚
â”‚            â”‚ ID: 1002  â”‚                          â”‚       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç‰¹ç‚¹
- **ç´§å‡‘å¸ƒå±€** - ä¸€è¡Œä¸€æ¡è®°å½•
- **é¢œè‰²åŒºåˆ†** - ç›ˆåˆ©ç»¿è‰²ï¼ŒäºæŸçº¢è‰²
- **çŠ¶æ€æ¸…æ™°** - æœªç»“ç®—/å·²å–æ¶ˆæ˜¾ç¤ºä¸åŒé¢œè‰²
- **ä¿¡æ¯å®Œæ•´** - åŒ…å«æ‰€æœ‰å…³é”®ä¿¡æ¯

## ä¸‰ã€æ‰€æœ‰äººä¸‹æ³¨æ€»å’Œï¼ˆå³ä¾§é¢æ¿ï¼‰

### ä½ç½®
- å³ä¸Šè§’å›ºå®šé¢æ¿
- å®½åº¦ï¼š320px
- sticky å¸ƒå±€ï¼Œè·Ÿéšæ»šåŠ¨

### åŠŸèƒ½

#### 3.1 æ±‡æ€»ç»Ÿè®¡
**ç»Ÿè®¡èŒƒå›´ï¼š**
- ä»¥ç­›é€‰çš„**æœŸå·**ä¸ºä¸»
- å¯å åŠ ç”¨æˆ·æ¡ä»¶ï¼ˆç­›é€‰å•ä¸ªç”¨æˆ·ï¼‰
- æ’é™¤å·²å–æ¶ˆçš„ä¸‹æ³¨

**ç»Ÿè®¡æ–¹å¼ï¼š**
- æŒ‰ç©æ³•å†…å®¹åˆ†ç±»æ±‡æ€»
- åŒä¸€ç©æ³•çš„æ‰€æœ‰äººä¸‹æ³¨ç›¸åŠ 

**ç¤ºä¾‹ï¼š**
```
ç”¨æˆ· A: 500(2å€) + 100(å¤§å•)
ç”¨æˆ· B: 500(2å€) + 100(å°åŒ)
ç”¨æˆ· C: 500(2å€)

æ±‡æ€»æ˜¾ç¤ºï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2å€    1500    â”‚
â”‚  å¤§å•    100    â”‚
â”‚  å°åŒ    100    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.2 é™¤ä»¥æ˜¾ç¤ºåŠŸèƒ½

**é…ç½®é¡¹ï¼š**
- **å¼€å…³** - å¯ç”¨/ç¦ç”¨é™¤æ•°æ˜¾ç¤º
- **é™¤æ•°è¾“å…¥æ¡†** - æ”¯æŒå°æ•°ï¼ˆ0.01-1000ï¼‰

**è®¡ç®—è§„åˆ™ï¼š**
```
æ˜¾ç¤ºå€¼ = åŸå§‹æ±‡æ€»å€¼ Ã· é™¤æ•°
```

**ç¤ºä¾‹ï¼š**
```
åŸå§‹æ±‡æ€»ï¼š
- 2å€: 1000
- å¤§å•: 100
- å°åŒ: 100

è®¾ç½®é™¤æ•°: 7.2

æ˜¾ç¤ºä¸ºï¼š
- 2å€: 138.89    (1000 Ã· 7.2)
- å¤§å•: 13.89    (100 Ã· 7.2)
- å°åŒ: 13.89    (100 Ã· 7.2)
```

### ç•Œé¢å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ‰€æœ‰äººä¸‹æ³¨æ€»å’Œ                  â”‚
â”‚                                 â”‚
â”‚  [âœ“] å¯ç”¨é™¤æ•°  [é™¤æ•°: 7.2___]   â”‚
â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  2å€      â”‚ 138.89   â”‚       â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚
â”‚  â”‚  å¤§å•     â”‚ 13.89    â”‚       â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚
â”‚  â”‚  å°åŒ     â”‚ 13.89    â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                 â”‚
â”‚  [æœŸå·: 20231127001]            â”‚
â”‚  [æ˜¾ç¤ºæ¨¡å¼: åŸå§‹å€¼ Ã· 7.2]      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## å››ã€æŠ€æœ¯å®ç°

### å‰ç«¯å®ç°

#### 4.1 APIæ¥å£

**æ–‡ä»¶ï¼š** `frontend-admin/src/api/bets.ts`

```typescript
// è·å–ä¸‹æ³¨æ±‡æ€»
export const getBetSummary = (params: {
  issue?: string
  userId?: number
}) => {
  return request.get<any, ApiResponse<Record<string, number>>>(
    '/admin/bets/summary', 
    { params }
  )
}
```

#### 4.2 é™¤æ•°è®¡ç®—

```typescript
// è®¡ç®—æ˜¾ç¤ºçš„æ±‡æ€»æ•°æ®ï¼ˆåº”ç”¨é™¤æ•°ï¼‰
const displaySummary = computed(() => {
  if (!divideEnabled.value || divideNumber.value <= 0) {
    return summaryData.value // ä¸å¯ç”¨é™¤æ•°ï¼Œè¿”å›åŸå§‹å€¼
  }

  const result: Record<string, number> = {}
  for (const [key, value] of Object.entries(summaryData.value)) {
    result[key] = value / divideNumber.value
  }
  return result
})
```

#### 4.3 å“åº”å¼å¸ƒå±€

```scss
// æ¡Œé¢ç«¯ï¼šåˆ—è¡¨ + å³ä¾§æ±‡æ€»
.content-wrapper {
  display: flex;
  gap: 20px;
  
  .bet-list-section {
    flex: 1;
  }
  
  .summary-section {
    width: 320px;
    position: sticky;
    top: 20px;
  }
}

// å°å±å¹•ï¼šä¸Šä¸‹å¸ƒå±€
@media (max-width: 1400px) {
  .content-wrapper {
    flex-direction: column;
  }
  
  .summary-section {
    width: 100%;
    position: static;
  }
}
```

### åç«¯å®ç°

#### 4.1 æ§åˆ¶å™¨

**æ–‡ä»¶ï¼š** `backend/src/modules/bet/bet.controller.ts`

```typescript
@Get('admin/bets/summary')
@UseGuards(RolesGuard)
@Roles('admin', 'superadmin')
@ApiOperation({ summary: 'è·å–ä¸‹æ³¨æ±‡æ€»ï¼ˆæ‰€æœ‰äººä¸‹æ³¨æ€»å’Œï¼‰' })
async getBetSummary(
  @Query('issue') issue?: string,
  @Query('userId') userId?: number,
) {
  return this.betService.getBetSummary(issue, userId);
}
```

#### 4.2 æœåŠ¡å±‚

**æ–‡ä»¶ï¼š** `backend/src/modules/bet/bet.service.ts`

```typescript
async getBetSummary(issue?: string, userId?: number) {
  const where: any = {
    status: { not: 'cancelled' }, // æ’é™¤å·²å–æ¶ˆçš„ä¸‹æ³¨
  };

  if (issue) {
    where.issue = issue;
  }

  if (userId) {
    where.userId = userId;
  }

  // æŸ¥è¯¢æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„ä¸‹æ³¨è®°å½•
  const bets = await this.prisma.bet.findMany({
    where,
    select: {
      betType: true,
      betContent: true,
      amount: true,
    },
  });

  // æŒ‰ betContent æ±‡æ€»é‡‘é¢
  const summary: Record<string, number> = {};

  for (const bet of bets) {
    const key = bet.betContent;
    
    if (!summary[key]) {
      summary[key] = 0;
    }
    
    summary[key] += Number(bet.amount);
  }

  return summary;
}
```

## äº”ã€æ•°æ®è¯´æ˜

### ç©æ³•æ˜ å°„

| æ•°æ®åº“å­˜å‚¨ | æ˜¾ç¤ºæ ‡ç­¾ | è¯´æ˜ |
|-----------|---------|------|
| `2` | 2å€ | å€æ•°ç©æ³• |
| `3` | 3å€ | å€æ•°ç©æ³• |
| `5` | 5å€ | å€æ•°ç©æ³• |
| `10` | 10å€ | å€æ•°ç©æ³• |
| `å¤§` | å¤§ | ç»„åˆç©æ³• |
| `å°` | å° | ç»„åˆç©æ³• |
| `å•` | å• | ç»„åˆç©æ³• |
| `åŒ` | åŒ | ç»„åˆç©æ³• |
| `å¤§å•` | å¤§å• | ç»„åˆç©æ³• |
| `å¤§åŒ` | å¤§åŒ | ç»„åˆç©æ³• |
| `å°å•` | å°å• | ç»„åˆç©æ³• |
| `å°åŒ` | å°åŒ | ç»„åˆç©æ³• |

### é™¤æ•°æ˜¾ç¤ºè§„åˆ™

| é™¤æ•°å€¼ | æ˜¾ç¤ºæ ¼å¼ | ç¤ºä¾‹ |
|--------|---------|------|
| æœªå¯ç”¨ / 0 / 1 | æ•´æ•° | 1000 |
| å¯ç”¨ + æœ‰æ•ˆå€¼ | å°æ•°ï¼ˆ2ä½ï¼‰ | 138.89 |

## å…­ã€ä½¿ç”¨åœºæ™¯

### åœºæ™¯1ï¼šæŸ¥çœ‹å•æœŸæ‰€æœ‰äººä¸‹æ³¨
```
1. è¾“å…¥æœŸå·ï¼š20231127001
2. ç‚¹å‡»æœç´¢
3. æŸ¥çœ‹ï¼š
   - å·¦ä¾§åˆ—è¡¨ï¼šæ¯ä¸ªç”¨æˆ·çš„ä¸‹æ³¨æ˜ç»†
   - å³ä¾§é¢æ¿ï¼šæ‰€æœ‰äººçš„ä¸‹æ³¨æ±‡æ€»
```

### åœºæ™¯2ï¼šæŸ¥çœ‹å•ä¸ªç”¨æˆ·ä¸‹æ³¨
```
1. è¾“å…¥ç”¨æˆ·IDï¼š1001
2. ï¼ˆå¯é€‰ï¼‰è¾“å…¥æœŸå·
3. ç‚¹å‡»æœç´¢
4. æŸ¥çœ‹è¯¥ç”¨æˆ·çš„ä¸‹æ³¨è®°å½•å’Œæ±‡æ€»
```

### åœºæ™¯3ï¼šä½¿ç”¨é™¤æ•°æŠ˜ç®—æ˜¾ç¤º
```
1. è¾“å…¥æœŸå·
2. æŸ¥çœ‹æ±‡æ€»
3. å¯ç”¨"å¯ç”¨é™¤æ•°"å¼€å…³
4. è¾“å…¥é™¤æ•°ï¼š7.2
5. æ±‡æ€»æ•°å€¼è‡ªåŠ¨æŠ˜ç®—æ˜¾ç¤º
```

### åœºæ™¯4ï¼šå¯¼å‡ºæˆ–åˆ†æ
```
åŸå§‹æ•°æ®ï¼šç³»ç»Ÿå†…éƒ¨ä½¿ç”¨
æŠ˜ç®—æ˜¾ç¤ºï¼šæ–¹ä¾¿å¤–éƒ¨å¯¹è´¦æˆ–åˆ†æ
```

## ä¸ƒã€æ³¨æ„äº‹é¡¹

### é‡è¦è¯´æ˜

1. **åªå½±å“æ˜¾ç¤º**
   - é™¤æ•°åŠŸèƒ½åªå½±å“å‰ç«¯å±•ç¤º
   - åç«¯æ•°æ®å’Œç»“ç®—ä½¿ç”¨åŸå§‹å€¼
   - ä¸ä¼šä¿®æ”¹æ•°æ®åº“ä¸­çš„æ•°æ®

2. **æ±‡æ€»è§„åˆ™**
   - æ’é™¤å·²å–æ¶ˆçš„ä¸‹æ³¨
   - åªç»Ÿè®¡æœ‰æ•ˆä¸‹æ³¨
   - æŒ‰ç©æ³•å†…å®¹åˆå¹¶è®¡ç®—

3. **ç²¾åº¦å¤„ç†**
   - é™¤æ•°ï¼šæ”¯æŒ2ä½å°æ•°
   - æŠ˜ç®—ç»“æœï¼šæ˜¾ç¤º2ä½å°æ•°
   - åŸå§‹æ±‡æ€»ï¼šæ˜¾ç¤ºæ•´æ•°

4. **æ€§èƒ½è€ƒè™‘**
   - æ±‡æ€»åœ¨åç«¯è®¡ç®—
   - å‰ç«¯åªåšé™¤æ³•è¿ç®—
   - å®æ—¶æ›´æ–°ï¼Œæ— ç¼“å­˜

## å…«ã€å¿«é€Ÿæµ‹è¯•

### æµ‹è¯•æ­¥éª¤

1. **è®¿é—®é¡µé¢**
   ```
   http://localhost:5174/bet-records
   ```

2. **è¾“å…¥æœŸå·æµ‹è¯•**
   - è¾“å…¥ä¸€ä¸ªæœ‰æ•ˆæœŸå·
   - ç‚¹å‡»æœç´¢
   - éªŒè¯åˆ—è¡¨å’Œæ±‡æ€»æ˜¾ç¤º

3. **é™¤æ•°æµ‹è¯•**
   - å¯ç”¨é™¤æ•°å¼€å…³
   - è¾“å…¥é™¤æ•°ï¼š7.2
   - éªŒè¯æ±‡æ€»å€¼å˜åŒ–

4. **é‡ç½®æµ‹è¯•**
   - ç‚¹å‡»é‡ç½®æŒ‰é’®
   - éªŒè¯ç­›é€‰æ¡ä»¶æ¸…ç©º

## ä¹ã€å®ŒæˆçŠ¶æ€

- âœ… å‰ç«¯æ–°é¡µé¢ `BetRecordsNew.vue`
- âœ… ç²¾ç®€æŸ¥è¯¢åŒºï¼ˆæœŸå·+ç”¨æˆ·ï¼‰
- âœ… ä¼˜åŒ–åˆ—è¡¨å¸ƒå±€
- âœ… æ‰€æœ‰äººä¸‹æ³¨æ€»å’Œé¢æ¿
- âœ… é™¤ä»¥æ˜¾ç¤ºåŠŸèƒ½
- âœ… å“åº”å¼è®¾è®¡
- âœ… åç«¯æ±‡æ€»API
- âœ… è·¯ç”±æ›´æ–°
- âœ… ä»£ç  Linter æ£€æŸ¥é€šè¿‡

## åã€æ–‡ä»¶æ¸…å•

### æ–°å¢/ä¿®æ”¹æ–‡ä»¶

**å‰ç«¯ï¼š**
- `frontend-admin/src/views/BetRecordsNew.vue` - æ–°é¡µé¢
- `frontend-admin/src/api/bets.ts` - æ–°å¢æ±‡æ€»API
- `frontend-admin/src/router/index.ts` - æ›´æ–°è·¯ç”±

**åç«¯ï¼š**
- `backend/src/modules/bet/bet.controller.ts` - æ–°å¢æ±‡æ€»æ¥å£
- `backend/src/modules/bet/bet.service.ts` - æ–°å¢æ±‡æ€»æ–¹æ³•

---

**æ›´æ–°æ—¶é—´ï¼š** 2025-11-27
**é¡µé¢è·¯å¾„ï¼š** `/bet-records`
**æƒé™è¦æ±‚ï¼š** admin, superadmin



